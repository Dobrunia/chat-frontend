<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0" /> -->
    <include src="../../html_components/default_css_links.html"></include>
    <link rel="stylesheet" type="text/css" href="./music.css" />
  </head>
  <body>
    <div class="nav_wrapper">
      <div class="nav_elements" id="nav_elements">
        <include src="../../html_components/header.html"></include>
        <include src="../../html_components/announcement.html"></include>
        <include src="../../html_components/confirmation.html"></include>
        <div
          class="nav_content fallback back-row-toggle splat-toggle"
          id="nav_content"
        >
          <include src="../../html_components/navigation.html"></include>
          <div class="nav_sections" id="nav_sections">
            <div class="nav_music">
              <div class="search_music">
                <button
                  type="button"
                  class="upload_btn btn btn-secondary"
                  id="uploadButton"
                >
                  <svg
                    fill="none"
                    height="24"
                    viewBox="0 0 24 24"
                    width="24"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <g fill="currentColor">
                      <path
                        d="M19 19a1 1 0 1 1 0 2H5a1 1 0 1 1 0-2zm-7-2a1 1 0 0 1-1-1V5.41l-4.3 4.3a1 1 0 0 1-1.31.08l-.1-.08a1 1 0 0 1 0-1.42l6-6a1 1 0 0 1 1.42 0l6 6a1 1 0 0 1-1.42 1.42L13 5.4V16a1 1 0 0 1-1 1z"
                      ></path>
                    </g>
                  </svg>
                  <span>Загрузить свою аудиозапись</span>
                </button>
                <div class="all_tracks">
                  <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3">
                    <input
                      type="search"
                      class="all_tracks_input text-bg-dark form-control form-control-dark"
                      id="find_track"
                      placeholder="Поиск по..."
                      aria-label="Search"
                    />
                    <div
                      class="radio_btns btn-group btn-group-toggle"
                      data-toggle="buttons"
                    >
                      <label class="btn btn-secondary">
                        <input
                          type="radio"
                          name="options"
                          id="liked"
                          autocomplete="off"
                          checked
                        />Избранное
                      </label>
                      <label class="btn btn-secondary active">
                        <input
                          type="radio"
                          name="options"
                          id="name"
                          autocomplete="off"
                        />Треки
                      </label>
                      <label class="btn btn-secondary">
                        <input
                          type="radio"
                          name="options"
                          id="playlist"
                          autocomplete="off"
                        />Плейлисты
                      </label>
                    </div>
                  </form>
                  <div class="tracks" id="tracks">
                    <div class="spinner">
                      <div class="blob top"></div>
                      <div class="blob bottom"></div>
                      <div class="blob left"></div>
                      <div class="blob move-blob"></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="playlist_tracks_wrapper">
                <button
                  class="upload_btn btn btn-secondary"
                  id="createPlaylist"
                  title="Создать новый плейлист"
                >
                  Создать новый плейлист +
                </button>
                <form
                  class="form_tracks col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3"
                >
                  <input
                    type="search"
                    class="all_tracks_input text-bg-dark form-control form-control-dark"
                    placeholder="Поиск по плейлисту"
                    aria-label="Search"
                  />
                </form>
                <div class="palaylist_name" id="palaylist_name"></div>
                <div class="playlist_tracks" id="playlist_tracks"></div>
              </div>
              <div class="audioPlayer">
                <div class="audioControls">
                  <img
                    class="playerImg rotate"
                    id="playerImg"
                    src="../../img/def.PNG"
                    alt=""
                  />
                  <div class="hole"></div>
                  <span class="audioPlayer_name" id="AudioPlayerName"></span>
                </div>
                <audio
                  id="audioPlayer"
                  src=""
                  controls
                  preload="metadata"
                ></audio>
              </div>
            </div>
          </div>
          <div
            class="choose_playlist"
            id="choose_playlist0"
            style="display: none"
          >
            <span>Выберите плейлист</span>
            <div class="close-btn" id="closeChoosePlaylistButton">&times;</div>
            <div class="choose_playlist_wrapper" id="choose_playlist"></div>
          </div>
          <div class="upload-popup" id="uploadPopup">
            <div class="upload-content">
              <div class="close-btn" id="closeButton">&times;</div>
              <h2>Загрузка аудиозаписи</h2>
              <form id="uploadForm" enctype="multipart/form-data">
                <label for="audioFile">Выберите MP3 файл:</label>
                <input
                  type="file"
                  id="audioFile"
                  accept="audio/mpeg"
                  name="audioFile"
                  required
                />

                <label for="imageFile"
                  >Выберите изображение (опционально):</label
                >
                <input
                  type="file"
                  id="imageFile"
                  accept="image/jpeg, image/png"
                  name="imageFile"
                />

                <label for="trackName">Название трека:</label>
                <input type="text" id="trackName" name="trackName" required />

                <label for="trackAuthor">Автор трека:</label>
                <input
                  type="text"
                  id="trackAuthor"
                  name="trackAuthor"
                  required
                />

                <button type="submit">Загрузить</button>
              </form>
            </div>
          </div>
          <form
            class="playlistForm"
            id="playlistForm"
            enctype="multipart/form-data"
          >
            <div class="close-btn" id="closePlaylistForm">&times;</div>
            <div class="form-group" style="display: none">
              <label for="playlistPhoto">Фото для плейлиста</label>
              <input
                type="file"
                class="form-control-file"
                id="playlistPhoto"
                accept="image/*"
                onchange="displayPreview(event)"
              />
            </div>
            <label for="playlistPhoto">
              <img
                id="previewImage"
                src="../../img/def.PNG"
                alt="Preview"
                style="max-width: 200px; cursor: pointer; margin-top: 30px"
              />
            </label>

            <div class="form-group">
              <label for="playlistName">Название плейлиста</label>
              <input type="text" class="form-control" id="playlistName" />
            </div>

            <div class="form-group">
              <label for="playlistDescription">Описание</label>
              <textarea
                class="form-control"
                id="playlistDescription"
              ></textarea>
            </div>
            <button type="submit">Создать</button>
          </form>
        </div>
      </div>
    </div>
    <include src="../../html_components/spinner.html"></include>
  </body>
  <script defer>
    function displayPreview(event) {
      let input = event.target;

      if (input.files && input.files[0]) {
        let reader = new FileReader();

        reader.onload = function (e) {
          document.getElementById('previewImage').src = e.target.result;
          document.getElementById('previewImage').style.display = 'block';
        };

        reader.readAsDataURL(input.files[0]);
      }
    }
  </script>
  <script type="module" src="../general_handler.js" defer></script>
  <script type="module" src="./music_handler.js" defer></script>
</html>
